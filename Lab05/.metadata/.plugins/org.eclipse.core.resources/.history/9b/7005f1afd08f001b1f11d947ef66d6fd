package hust.soict.globalict.aims.order;
import java.util.*;
import hust.soict.globalict.aims.utils.*;
import hust.soict.globalict.aims.disc.DigitalVideoDisc;
public class Order {
	public static final int MAX_NUMBERS_ORDERED = 10;
	
	private Stack<DigitalVideoDisc> itemsOrdered = new Stack<DigitalVideoDisc>();
	private int qtyOrdered = itemsOrdered.size();
	private MyDate dateOrdered;
	public static final int MAX_LIMITED_ORDERS = 5;
	private static int nbOrders = 0;
	public void setQtyOrdered(int qtyOrdered) {
		this.qtyOrdered = qtyOrdered;
	}
	public void addDigitalVideoDisc(DigitalVideoDisc disc) {
		if (qtyOrdered < 10) {
			itemsOrdered.push(disc);
			qtyOrdered++;
			if (qtyOrdered != 9)
			System.out.println("The disc has been added");
			else if (qtyOrdered == 9)
			System.out.println("The disc has been added. Warning: The order is almost full");
		}
			if (qtyOrdered >= MAX_NUMBERS_ORDERED) {
				System.out.println("The order is full");
				return;
			}
	}
	public void addDigitalVideoDisc(DigitalVideoDisc [] dvdList) {
		for (int i=0; i< dvdList.length; i++)
		{
			if (qtyOrdered >= MAX_NUMBERS_ORDERED) {
				System.out.println("The order is full. List of the DVDs that are not added: ");
				for (int j=0; j< dvdList.length; j++) {
					System.out.println(dvdList[j]);
				}
				break;
			}
			else {
				itemsOrdered.push(dvdList[i]);
				System.arraycopy(dvdList, i+1, dvdList, i, dvdList.length - i - 1);
				qtyOrdered++;
			}
		}
	}
	public void addDigitalVideoDisc(DigitalVideoDisc dvd1,DigitalVideoDisc dvd2) {
		if (qtyOrdered < 9) {
			itemsOrdered.push(dvd1);
			itemsOrdered.push(dvd2);
			qtyOrdered += 2;
		}
		if (qtyOrdered >= MAX_NUMBERS_ORDERED) {
			System.out.println("The order is full");
			return;
		}
	}
	// My preference is using a method with array parameter over arbitrary number of arguments for dvd because I won't have to overload multiple cases for every number out there
	public void removeDigitalVideoDisc(DigitalVideoDisc disc) {
		itemsOrdered.removeElement(disc);
		qtyOrdered--;
		System.out.println("The disc has been removed");
	}
	public float totalCost() {
		float totalcost = 0.00f;
		DigitalVideoDisc[] arr = new DigitalVideoDisc[itemsOrdered.size()];
		arr = itemsOrdered.toArray(arr);
		for (int i=0; i< arr.length; i++) totalcost += arr[i].getCost();
		return totalcost;
	}
	public void printOrder() {
		DigitalVideoDisc[] arr = new DigitalVideoDisc[itemsOrdered.size()];
		arr = itemsOrdered.toArray(arr);
		System.out.println("***********************Order***********************");
		System.out.println("Date: " + dateOrdered);
		System.out.println("Ordered items: ");
		for (int i=0; i< arr.length; i++) {
			System.out.println(i+1 + "." + arr[i].getTitle() + "-" + arr[i].getCategory() + "-" + arr[i].getDirector() + "-" + arr[i].getLength() + ":" + arr[i].getCost() + "$");
			if (arr[i].getCost() == 0) System.out.println(i+1 + "." + arr[i].getTitle() + "-" + arr[i].getCategory() + "-" + arr[i].getDirector() + "-" + arr[i].getLength() + ":" + arr[i].getCost() + "$" + "(Lucky DVD)");
		}
		System.out.println("Total cost: " + totalCost());
	}
	public DigitalVideoDisc getALuckyItem() {
		int randomIndex = (int)(Math.random() * itemsOrdered.size());
		itemsOrdered.get(randomIndex).setCost(0.0f);
		return itemsOrdered.get(randomIndex);
	}
}
